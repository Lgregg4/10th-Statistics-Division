---
title: "Lab5"
author: "Lauren, Chris, Ryan, Katie"
date: "2/16/2018"
output: html_document
---

```{r setup, include=FALSE}
## notice i load the data here so we dont have to do it each indiviudally
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
ms <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/ms.csv") # load the data
```


```{r}

ms_4 <- ms %>% filter(spec5 > 1 & spec5<10000)%>%mutate(log.spec5 = log10(spec5),log.spec10 =log10(spec10),diff = abs(spec5-spec10)) #create the new dataset

ggplot(data = ms_4,aes(x=mass,y = log.spec5))+geom_violin() #the plot of mass vs. log spec5

```

```{r}

ggplot(data = ms_4,aes(x=mass,y = log.spec5))+geom_bin2d(binwidth = c(5,0.1))

```

```{r}

ms5 <- ms_4 %>% filter(diff<150)
ggplot(data = ms5,aes(x=diff))+geom_histogram()
```



# Lauren Gregg
## Variance
```{r}
msLG <- ms %>% filter(mass>50)
ggplot(data=msLG, aes(mass, spec5)) + 
  geom_point()
```

Because so many values of mass are close to zero, it is difficult to see the variance in the "heavier" particles. I decided to filter all particles with mass less than 50 out of the data set. Plotting this data, we can see peaks occur around masses of 75, 150, 175, 210, 275, and 350. This is not visible without filtering the data.

## Covariance
```{r}
ggplot(data=msLG, aes(spec5, spec10)) +
  geom_point()
```

In order to continue on my path, I was interested in seeing if a strong correlation between spec5 and spec10 was still visible when considering only the objects with mass greater than 50. The covariation between the variables is still very evident. 

```{r}
cor(msLG$spec5, msLG$spec10)
```

```{r}
cor(ms$spec10, ms$spec5)
```

The correlation is moderate with a coeffecient of 0.67. However, this is much less than the coefficient of 0.99, which is the result if we consider objects with a mass less than 50.

#Katie

##Variance
```{r}
#install.packages("hexbin")
library(hexbin)
ms %>% summarise(total = length(spec5),
                 numNAs = sum(is.na(spec5)),
                 neg = length(spec5[spec5<0]), 
                 zero = length(spec5[spec5==0]),
                 small = length(spec5[spec5>0 & spec5<=100]),
                 med = length(spec5[spec5>100 & spec5<=1000]),
                 large = length(spec5[spec5>1000 & spec5<=10000]),
                 realbig = length(spec5[spec5>10000 & spec5<=100000]))

mas<-ms %>% filter(spec10>0 & spec10 <5000 & mass < 200) %>% mutate(log(spec10)) %>% arrange(desc(spec10))
ggplot(mas)+
  geom_hex(mapping = aes(y = spec10, x = mass))
```

First I plot the variation about the spec10 with mass without filtering, and I found there are lots of points stick together and the density is large, and it's hard to visualize the actual spec10 points. So I narrowed down the scales , took the logarithm and pick some specific arranges about the data, in this case, it's easier to read the tendency and the spread of those points.
```{r}
#install.packages("GGally")
library(GGally)
mms <- ms %>% filter(spec5>0 & spec5<5000 & spec10>0 & spec10<5000) 
mea <- mms %>% summarise(mean(spec5),mean(spec10))
ggplot(mms,mapping = aes(y = spec5,x = spec10,color = mass))+
  geom_point()+
  geom_smooth(method = "lm", se = TRUE)+
  labs(x = "spec10",y = "spec5",title = "The corelation between spec5 and spec10, and their mean values are \n spec5:30.23052, spec10: 26.9792")
```
```{r}
cor(mms$spec5,mms$spec10)
```

For the correlation part, I narrowed it down and pick the same scale to plot the points for each variable. Then I calculated the mean value for spec5 and spec10, which I found they??re close. The mean for spec5 is 30.23052, for spec10 is 26.9792, and the close relationship could be visualize from the plot---they are not far away from each other. And the correlation is 0.857, which is close to 0.99. 
