<<<<<<< HEAD

---
title: "Lab11"
author: "Lauren Gregg, Katie Jiang, Ryan Marizza, Chris He"
date: "4/06/2018"
output: html_document
---


```{r setup, include=FALSE}
library(babynames)
library(stringr)
library(tidyverse)
rm(list=ls()) # clears your environment variables

```
#Analyzing Baby Names
# Team Work

 
# Individual Work
 

## Lauren
## First three letters of names
## Ariel and Rachel regexs
## The Little Mermaid Effect
## Your names


## Kaite
## First three letters of names

```{r}
sum(str_count(babynames$name,"Kat"))
sum(str_count(babynames$name,"kat"))
```
ratio of "Kat" = 0.96
## Ariel and Rachel regexs

```{r}
Rach1973 <- filter(babynames,str_detect(babynames$name,"^Rach[:lower]*l"),year==1973,sex =="F")%>% count()
Rach1988 <- filter(babynames,str_detect(babynames$name,"^Rach[:lower]*l"),year==1988,sex =="F")%>% count()
Rach1990 <- filter(babynames,str_detect(babynames$name,"^Rach[:lower]*l"),year==1990,sex =="F")%>% count()
Rach1973
Rach1988
Rach1990

Arie1973 <- filter(babynames,str_detect(babynames$name,"Ariel"),year==1973,sex =="F")%>%count()
Ariel1988 <-  filter(babynames,str_detect(babynames$name,"Ariel"),year==1988,sex =="F")%>% count()
Ariel1990 <-  filter(babynames,str_detect(babynames$name,"Ariel"),year==1990,sex =="F")%>% count()
Arie1973
Ariel1988
Ariel1990

g1973 <- filter(babynames,year == 1973, sex == "F") %>% count()
chance1973 <- (Rach1973+Arie1973)/g1973
chance1973
g1988 <- filter(babynames,year == 1988,sex == "F") %>% count()
chance1988 <- (Rach1988+Ariel1988)/g1988
chance1988

g1990 <- filter(babynames, year == 1990, sex == "F") %>% count()
chance1990 <- (Rach1990+Ariel1990)/g1973
chance1990
```
The number of versions for Rachel in 1973 is 5, in 1988 is 7, and in 1990 is 5.
The number of versions for Ariel in 1973 is 3, in 1988 is 6, and in 1990 is 6.
The chances of girl bron in 1973 named Rachel or Ariel is 0.000816, in 1988 is 0.000937, and in 1990 is 0.00122
## The Little Mermaid Effect

```{r}
girl <- babynames%>%filter(sex == 'F')
names<-girl%>%filter(str_detect(name,"^A"))%>%filter(year == 1988 | year == 1990)

n1988<-names%>%filter(year == 1988)
n1990<-names%>%filter(year == 1990)

Adiff<-left_join(n1988,n1990,by = 'name')%>%mutate(diff = prop.x-prop.y)%>% select(name,prop.x,prop.y,diff)

Ariel.diff <- filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1990,sex=="F") %>% count(wt=prop) - filter(babynames,str_detect(babynames$name,"Ar[iy]+.l+[^a]?$"),year==1988,sex=="F") %>% count(wt=prop)
Ariel.diff
# the percentile of Ariel changes
filter(Adiff,diff<Ariel.diff) %>% arrange(desc(diff))
filter(Adiff,diff<Ariel.diff) %>% count()/names %>% count()


ggplot(Adiff) +
  geom_histogram(aes(x=diff),bins=50) + xlim(-0.003,0.003)+
  geom_vline(aes(xintercept=Ariel.diff),color="red",lwd=1) 

```
The percentile of changing to Ariel is 100%, because there is no other names with difference that is bigger than Ariel. The other girls' name has the distribution aroud 0, which means they have slightly changes. However, the difference for Ariel is far away on the right side of the plot, which means it has a great change. Thus, comparing to other girl's names, the Ariel have a bigger change over time.
## Your names

```{r}
my <- babynames %>% filter(sex == "F")
ka <- my %>% filter(str_detect(name,"^Katie")) %>% filter(year == 1998 | year == 2015)
n1998 <- ka %>% filter(year == 1998)
n2015 <- ka %>% filter(year == 2015)
changeka <- left_join(n1998,n2015, by = "name") %>% mutate(diff = prop.x- prop.y) %>% count(wt = diff)
changeka

ka1981 <- my %>%filter(str_detect(name,"^Katie")) %>% filter(year == 1981 | year == 1998)
n1981 <- ka1981 %>% filter(year == 1981)
changeka2 <- left_join(n1981,n1998, by = "name") %>% mutate(diff = prop.x - prop.y) %>% count(wt = diff)
changeka2

all98<- filter(babynames,year == 1998)
all15<- filter(babynames,year == 2015)
```
My name Katie have the difference 0.00138 from 1998 to 2015, and have 0.00177 from 1981 to 1998.

```{r}
#actucal change in propotion
Katie.diff <- filter(babynames,str_detect(babynames$name,"^Katie"),year==1998,sex=="F") %>% count(wt=prop) - filter(babynames,str_detect(babynames$name,"^Katie"),year==2015,sex=="F") %>% count(wt=prop)
Katie.diff
#relative change in precentile
Kgirl <- filter(babynames,str_detect(babynames$name , "^K"),year == 1998|year == 2015)
n1998 <- Kgirl %>% filter(year == 1998)
n2015 <- Kgirl %>% filter(year == 2015)

Kdiff<-left_join(n1998,n2015,by = 'name')%>%mutate(diff = prop.x-prop.y)%>% select(name,prop.x,prop.y,diff)

filter(Kdiff,diff<Katie.diff) %>% arrange(desc(diff))
filter(Kdiff,diff<Katie.diff) %>% count() 

#plot shows the difference
inner_join(all98,all15,by = "name") %>% mutate(df = prop.x-prop.y)%>%
  select(name,prop.x,prop.y,df)%>%
  ggplot()+geom_histogram(mapping = aes(x = df),bins = 40)+xlim(-0.003,0.003)+
  geom_vline(aes(xintercept = changeka),color = "red",lwd =1)+
  labs(x = "Difference", y ="Count", title = "The changes of Katie between 1998 and 2015")

```
The actucal change for Katie is 0.00138, and the relative change is 100% from 1998 to 2015, which is the percentile. Because there is no other names have the bigger changes than mine, which we could also see from the plot.

```{r}
#actucal change in propotion
Katie.diff1 <- filter(babynames,str_detect(babynames$name,"^Katie"),year==1981,sex=="F") %>% count(wt=prop) - filter(babynames,str_detect(babynames$name,"^Katie"),year==1998,sex=="F") %>% count(wt=prop)
Katie.diff1
#relative change in precentile
Kgirl1 <- filter(babynames,str_detect(babynames$name , "^K"),year == 1998|year == 1981)
n1998 <- Kgirl %>% filter(year == 1998)
n1981 <- Kgirl %>% filter(year == 2015)

Kdiff1<-left_join(n1998,n1981,by = 'name')%>%mutate(diff = prop.x-prop.y)%>% select(name,prop.x,prop.y,diff)
Kdiff1
filter(Kdiff1,diff< Katie.diff1) 
filter(Kdiff1,diff<Katie.diff1) %>% count() /Kgirl1 %>% count()

#plot shows the change
all81 <- filter(babynames,year == 1981)
inner_join(all81,all98, by = "name")%>%
  mutate(df = prop.x-prop.y)%>%
  select(name,prop.x,prop.y,df)%>%
  ggplot()+geom_histogram(mapping = aes(x = df),bins = 30)+xlim(-0.01,0.01)+
  geom_vline(aes(xintercept = changeka2),color = "red",lwd=1)+
  labs(x = "Difference", y ="Count", title = "The changes of Katie between 1981 and 1998")
```
The actual change for Katie from 1981 to 1998 is 0.00177, and the relative change in percentile is 100%. And we can see from the plot that my name become more popular comparing to others



## Ryan
## First three letters of names
## Ariel and Rachel regexs
## The Little Mermaid Effect
## Your names
`
## Chris
## First three letters of names
## Ariel and Rachel regexs
## The Little Mermaid Effect
## Your names


# Summary of Who did What

## Lauren


## Kaite
I outlined the lab11 and divided each section for each teammates. In my individual part, I first found the ratio of first three letters of my name by using str_count. And I found the number of versions of Ariel and Rachel in 1973,1988 and 1990. The number of difference is increasing, which indicates that there is a effect to names based on The Little Mermaid. Then to prove it, I plot the change for Ariel from 1988 to 1990. Lastly, for my names, I plot two histograms to show the changes from the year that I was born to 2015 and from 17 years before I was born to the year I was born.
## Ryan


## Chris

                                                                        