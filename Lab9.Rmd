---
title: "Lab 9"
author: "Lauren, Chris, Ryan, Katie"
date: "3/15/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(nycflights13)
library(forcats)
library(lubridate)
library(stringr)
library(dplyr)
```

# Overall Team Question
why its important
why those reasons are important

THOUGHT: How have trends changed in political party self identification?
An answer to this question would allow politicians and law makers to understand where the country's political mind. Ideally, this knowledge would help to make policy changes in the best interest of the country's opinion.

# Conclusion
```{r}
unique(gss_cat$partyid)

data <- gss_cat %>%
  mutate(partyid = fct_recode(partyid,
                              "Republican"  = "Strong republican",
                              "Republican"  = "Not str republican",
                              "Independent" = "Ind,near rep",
                              "Independent" = "Ind,near dem",
                              "Democrat"    = "Not str democrat",
                              "Democrat"    = "Strong democrat",
                              "Other"       = "No answer",
                              "Other"       = "Don't know",
                              "Other"       = "Other party"
  )) %>%
  select(-c(marital, age, race, rincome, relig, denom, tvhours)) %>%
  count(year, partyid)  %>%
  group_by(year) %>%
  mutate(p = n / sum(n))

ggplot(data, aes(x = year, y = p, colour = fct_reorder2(partyid, year, p))) +
  geom_point() +
  geom_line() +
  labs(colour = "Party ID")
```

There are a few trends that we can observe in the political trends. The percentage of individuals who identify as a republican has been decreasing since 2004. The percentage od individuals who identify as independent seems to be, overall, increasing. 

This tells law makers and politicians that the public may be transisitioning to supporting ideas rather than parties. Perhaps, when presenting ideas, individuals shouldn't focus on the liberal or conservatice ideas, but the overall potential changes the ideas could cause.



# Individual Findings and Plots

## Lauren

### 13.4.6.2
Add the location of the origin and destination (the lat and lon) to flights.
```{r, 13.4.6.2}
airports2 <- airports %>% select(-c(alt, tz, dst, tzone, name))

flights2 <- flights %>% 
  left_join(airports2, by = c("dest" = "faa")) %>%
  rename(dest_lon = lon) %>%
  rename(dest_lat = lat)

flights2 <- flights2 %>%
  left_join(airports2, by = c("origin" = "faa" )) %>%
  rename(origin_lon = lon) %>%
  rename(origin_lat = lat)

head(flights2)
```

### 14.2.5.3
####Use str_length() and str_sub() to extract the middle character from a string. What will you do if the string has an even number of characters?

```{r, 14.2.5.3}
string <- "Hi, my name is Lauren."
len <- str_length(string)
mid_char <- str_sub(string, len/2, len/2)
mid_char
```

The above code works with an uneven number of characters. str_sub() automatically rounds down. If I change the string to be "Hi, my name is Lauren!!", the middle character will still be 'e' even though the length of the string is 23.

### 15.5.1.1
####How have the proportions of people identifying as Democrat, Republican, and Independent changed over time?

```{r, 15.5.1.1}
unique(gss_cat$partyid)

data <- gss_cat %>%
  mutate(partyid = fct_recode(partyid,
                              "Republican"  = "Strong republican",
                              "Republican"  = "Not str republican",
                              "Independent" = "Ind,near rep",
                              "Independent" = "Ind,near dem",
                              "Democrat"    = "Not str democrat",
                              "Democrat"    = "Strong democrat",
                              "Other"       = "No answer",
                              "Other"       = "Don't know",
                              "Other"       = "Other party"
  )) %>%
  select(-c(marital, age, race, rincome, relig, denom, tvhours)) %>%
  count(year, partyid)  %>%
  group_by(year) %>%
  mutate(p = n / sum(n))

ggplot(data, aes(x = year, y = p, colour = fct_reorder2(partyid, year, p))) +
  geom_point() +
  geom_line() +
  labs(colour = "Party ID")
```

There has not been any drastic changes in the proportions of how people identify their political party. We have seen a consistent descrease in republican identification 2004.

### 16.2.4.3
####Use the appropriate lubridate function to parse each of the following dates:
```{r, 16.2.4.3}
d1 <- "January 1, 2010"
d2 <- "2015-Mar-07"
d3 <- "06-Jun-2017"
d4 <- c("August 19 (2015)", "July 1 (2015)")
d5 <- "12/30/14" # Dec 30, 2014
```
```{r, 16.4.3.d1}
mdy(d1)
```
```{r, 16.4.3.d2}
ymd(d2)
```
```{r, 16.4.3.d3}
dmy(d3)
```
```{r, 16.4.3.d4}
mdy(d4)
```
```{r, 16.4.3.d5}
mdy(d5)
```


## Chris
### 13.5.1
### 2.Filter flights to only show flights with planes that have flown at least 100 flights.
```{r}
G100 <- filter(flights) %>%group_by(tailnum) %>%count() %>%filter(n > 100)

flights %>%
  semi_join(G100, by = "tailnum")
```


### 14.4.5 
### 1.Replace all forward slashes in a string with backslashes.
```{r}
str = "iamgood/prettygood/\\/reallygood"
writeLines(str)
writeLines(str_replace_all(str, "/", "\\\\"))
```
just change forward slashes to backslashes, and I need to double it.

### 15.5.1 Exercises
### 2???How could you collapse rincome into a small set of categories?
```{r}
gss_cat %>%
  mutate(rincome =
           fct_collapse(
             rincome,
             `Uknow` = c("No answer", "Don't know", "Refused", "Not applicable"),
             `Lt $10000` = c("Lt $1000", str_c("$", c("1000", "3000", "4000","5000", "6000", "7000", "8000"),
                                              " to ", c("2999", "3999", "4999","5999", "6999", "7999", "9999"))),
             `$10000 to 20000` = str_c("$", c( "10000", "15000"),
                                      " - ", c("14999", "19999"))
              
           )) %>%
  ggplot(aes(x = rincome)) +
  geom_bar() 
```
I decided to change rincome to four group or set, all the uknow rincome, lt than 10000, from 10000 to 20000 and large than 20000 I dont change, and use a geom_bar to show the relation.

### 16.3.4 Exercises
### 5.On what day of the week should you leave if you want to minimise the chance of a delay???
```{r}
flights_dt %>%
  mutate(leave = wday(sched_dep_time)) %>%
  group_by(leave) %>%
  summarise(dep_delay = mean(dep_delay,na.rm=TRUE),
            arr_delay = mean(arr_delay, na.rm = TRUE))
```
from the tb that we got, it is very easily to say tha if we want to leave we should choose sunday.

## Ryan

## Katie




# Who Did What

## Lauren
I completed the assignment for this lab by solving four exercise problems: 13.4.6.2, 14.2.5.3, 15.5.1.1, and 16.2.4.3. For chapter 13, I implemented left_join() and rename(). Solving chapter 14's problem, I used str_length() and str_sub() as specified by the question. I used the most functions solving 15.5.1.1; mutate(), select(), count(), group_by(), and ggplot(). Finally, I completed 16.2.4.3 by simply using three different lubridate functions: mdy(d1), ymd(), and dmy().